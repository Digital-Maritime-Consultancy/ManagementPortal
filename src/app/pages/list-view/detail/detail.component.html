<div class="row">
  <div class="col-lg-12">
    <div *ngIf="!isMyOrgPage && !isForNew">
      <button nbButton status="info" ghost (click)="cancel()">
        <nb-icon icon="arrow-ios-back" pack="eva"></nb-icon> 
        Back to {{entityTypeName}} list
      </button>
    </div>
    <nb-card>
        <nb-card-header *ngIf="isLoaded">
          <div class="row">
            <div class="col my-auto">
              <span class="icon_header"><nb-icon [icon]="iconName" pack="fas"></nb-icon></span>{{name}}
            </div>
            <div class="col-md-auto">
              <button type="submit" nbButton status="primary" *ngIf="isForNew" (click)="submit()" [disabled]="!formGroup.valid">Submit</button>
              <button type="button" nbButton status="danger" *ngIf="isForNew" (click)="cancel()">Cancel</button>
              <button type="button" nbButton status="primary" *ngIf="!isEditing && !isForNew" (click)="invertIsEditing()" >Edit</button>
              <button type="submit" nbButton status="primary" *ngIf="isEditing && !isForNew" [disabled]="!formGroup.valid">Update</button>
              <button type="button" nbButton status="danger" *ngIf="isEditing && !isForNew" (click)="invertIsEditing()" >Cancel</button>
            </div>
          </div>
        </nb-card-header>
      
        <nb-card-body [nbSpinner]="isLoading" nbSpinnerSize="large" nbSpinnerStatus="primary">
          <div class="row" *ngIf="!isLoaded">
            <div class="col my-auto">
              <h1>Failed to load</h1>
            </div>
          </div>
          <form [formGroup]="formGroup" *ngIf="isLoaded">
            <div class="form-group row" *ngIf="isForNew">
              <label class="label col-sm-3 col-form-label">Short ID for MRN</label>
              <div class="col-sm-9 my-auto">
                <input type="text" nbInput fullWidth id="input_shortId" class="form-control" status="{{isShortIdValid ? 'success' : 'danger'}}" required="true" (input)="addShortIdToMrn($event.target.value)" value="{{shortId}}">
              </div>
            </div>
            <div class="form-group row" *ngFor="let attribute of columnForMenu">
              <label for="input{{attribute[0]}}" class="label col-sm-3 col-form-label" nbPopover="{{attribute[1].description}}" nbPopoverTrigger="hint" nbPopoverPlacement="top">{{attribute[1].title}}</label>
              <div class="col-sm-9 my-auto">
                <p class="my-auto" *ngIf="!isEditing" id="keyword.name">{{ formGroup.get(attribute[0]).value }}</p>
                <input *ngIf="isEditing" type="text" nbInput fullWidth id="input_{{attribute[0]}}" class="form-control" status="{{formGroup.get(attribute[0]).value ? formGroup.get(attribute[0]).valid ? 'success' : 'danger' : attribute[1].required ? 'danger' : ''}}" formControlName="{{attribute[0]}}" required="{{attribute[1].required === true}}">
              </div>
            </div>
            <div class="form-group row" *ngIf="isEntity && !isForNew && !isEditing" >
              <label for="inputActiveCert" class="label col-sm-3 col-form-label">Active certificates</label>
              <div class="col-sm-9">
                <ngx-certificates [data]="activeCertificates" [forRevoked]="false" [entityType]="menuType" [entityTitle]="name" [entityMrn]="entityMrn" [orgMrn]="orgMrn"></ngx-certificates>
              </div>
            </div>
            <div class="form-group row" *ngIf="isEntity && !isForNew && !isEditing" >
              <label for="inputRevokedCert" class="label col-sm-3 col-form-label">Revoked certificates</label>
              <div class="col-sm-9">
                <ngx-certificates [data]="revokedCertificates" [forRevoked]="true"></ngx-certificates>
              </div>
            </div>
            <div class="buttons-row">
              
              <button type="button" nbButton status="primary" *ngIf="isUnapprovedorg">Approve</button>
              <button type="button" nbButton status="danger" *ngIf="isUnapprovedorg">Reject</button>
            </div>
          </form>
        </nb-card-body>
      </nb-card>
  </div>
</div>

<notifier-container></notifier-container>